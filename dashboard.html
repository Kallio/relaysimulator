<!doctype html>
<html>
<head><meta charset="utf-8"><title>Sim Dashboard</title></head>
<body>
<h3>Simulator Dashboard</h3>
<div id="info">Connecting...</div>
<pre id="last"></pre>
<script>
let ws = new WebSocket("ws://"+location.host+"/ws");
ws.onopen = ()=> document.getElementById('info').innerText = 'Connected';
ws.onmessage = (e)=>{
  let d = JSON.parse(e.data);
  if(d.type==='init') document.getElementById('info').innerText = JSON.stringify(d.stats,null,2);
  if(d.type==='update') {
    document.getElementById('last').innerText = JSON.stringify(d.stats.last, null, 2);
    document.getElementById('info').innerText = 'Messages: '+d.stats.messages+' Connections: '+d.stats.connections;
  }
};
</script>
</body>
</html>
